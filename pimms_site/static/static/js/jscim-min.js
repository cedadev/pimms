/*!
 * jscim - javascript Library v0.8.4
 * https://github.com/ES-DOC/jscim
 *
 * Copyright 2012, ES-DOC (http://es-doc.org)
 *
 * Licensed under the following licenses:.
 *     CeCILL       http://www.cecill.info/licences/Licence_CeCILL_V2-en.html
 *     GPL v3       http://www.gnu.org/licenses/gpl.html
 *
 * Date: Fri 14 Sep 2012 21:19:21 UTC
 */

"use strict";window.$=window.$jq=jQuery.noConflict();(function(root){var CIM,options;if(!_.isUndefined(root.CIM)){return}options={mode:"prod",usePURL:true,uiFramework:"jquery.ui",uiMode:"tabbed",documentSchema:"1.5",documentLanguage:"en",shieldErrors:true,showCimInfo:false,set:function(opts){var error;if(_.isObject(opts)===false){error={type:"Setup",errors:["Plugin options must be an object"]};CIM.events.trigger("global:error",error);return}if(_.has(opts,"mode")){if(_.indexOf(CIM.utils.constants.modes.all,opts.mode)===-1){error={type:"Setup",errors:["Plugin mode option [{0}] is unsupported".replace("{0}",opts.mode)]};CIM.events.trigger("global:error",error);return}this.mode=opts.mode}if(_.has(opts,"usePURL")){if(_.isBoolean(opts.usePURL)===false){error={type:"Setup",errors:["Plugin usePURL option must be a boolean"]};CIM.events.trigger("global:error",error);return}this.usePURL=opts.usePURL}if(_.has(opts,"uiFramework")){if(_.indexOf(CIM.utils.constants.ui.frameworks.all,opts.uiFramework)===-1){error={type:"Setup",errors:["Plugin ui framework [{0}] is unsupported".replace("{0}",opts.uiFramework)]};CIM.events.trigger("global:error",error);return}this.uiFramework=opts.uiFramework}if(_.has(opts,"uiMode")){if(_.indexOf(CIM.utils.constants.ui.modes.all,opts.uiMode)===-1){error={type:"Setup",errors:["Plugin ui mode [{0}] is unsupported".replace("{0}",opts.uiFramework)]};CIM.events.trigger("global:error",error);return}this.uiMode=opts.uiMode}if(_.has(opts,"documentSchema")){this.documentSchema=opts.documentSchema}if(_.has(opts,"documentLanguage")){this.documentLanguage=opts.documentLanguage}if(_.has(opts,"shieldErrors")){if(_.isBoolean(opts.shieldErrors)===false){error={type:"Setup",errors:["Plugin shieldErrors option must be a boolean"]};CIM.events.trigger("global:error",error);return}this.shieldErrors=opts.shieldErrors}if(_.has(opts,"showCimInfo")){if(_.isBoolean(opts.showCimInfo)===false){error={type:"Setup",errors:["Plugin showCimInfo option must be a boolean"]};CIM.events.trigger("global:error",error);return}this.showCimInfo=opts.showCimInfo}}};root.CIM=root.cim=CIM={APP_VERSION:"0.8.4",events:_.extend({triggerError:function(type,error){CIM.events.trigger("global:error",{type:type,errors:[error]})}},Backbone.Events),utils:{views:{core:{}}},views:{utils:{}},options:options,setOptions:function(opts){options.set(opts)}};CIM.events.on("global:error",function(error){var ex,lr="\n";if(_.isUndefined(error.errors)){error.errors="An unknown error has occurred.  If this persists please contact jscim @ github"}if(_.isArray(error.errors)==false){error.errors=[error.errors]}ex=new Error();ex.name=CIM.utils.constants.app.getCaption();ex.name+=" - {0} Error";ex.name=ex.name.replace("{0}",error.type);if(CIM.options.shieldErrors===true){lr="<br />"}ex.message=_.reduce(error.errors,function(memo,msg){return memo+msg+lr},"");if(CIM.options.shieldErrors===true){CIM.events.trigger("message:error",ex.message,ex.name)}else{CIM.events.trigger("cim:error",ex)}})})(this||window);

(function(root){var CIM=root.CIM;CIM.utils.constants={app:{NAME:"ES-DOC - jsCIM",VERSION:"0.8.4",getCaption:function(){var caption;caption=CIM.utils.constants.app.NAME;caption+=" (v";caption+=CIM.utils.constants.app.VERSION;caption+=")";return caption}},ui:{frameworks:{all:["none","jquery.ui","twitter.bootstrap","sencha.extjs"],NONE:"none",JQUERY:"jquery.ui",BOOTSTRAP:"twitter.bootstrap",EXTJS:"sencha.extjs"},modes:{all:["tabbed","inline"],TABBED:"tabbed",INLINE:"inline"},NULL_FIELD:"--"},modes:{all:["dev","prod","test"],DEV:"dev",PROD:"prod",TEST:"test"}}})(this||window);

(function(root){if(typeof String.prototype.startsWith!="function"){String.prototype.startsWith=function(str){return this.slice(0,str.length)==str}}if(typeof String.prototype.trim!="function"){String.prototype.trim=function(str){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}})(this||window);

(function($){function noop(){}function genericCallback(data){lastValue=[data]}function callIfDefined(method,object,parameters,returnFlag){try{returnFlag=method&&method.apply(object.context||object,parameters)}catch(_){returnFlag=!1}return returnFlag}function qMarkOrAmp(url){return/\?/.test(url)?"&":"?"}var STR_ASYNC="async",STR_CHARSET="charset",STR_EMPTY="",STR_ERROR="error",STR_INSERT_BEFORE="insertBefore",STR_JQUERY_JSONP="_jqjsp",STR_ON="on",STR_ON_CLICK=STR_ON+"click",STR_ON_ERROR=STR_ON+STR_ERROR,STR_ON_LOAD=STR_ON+"load",STR_ON_READY_STATE_CHANGE=STR_ON+"readystatechange",STR_READY_STATE="readyState",STR_REMOVE_CHILD="removeChild",STR_SCRIPT_TAG="<script>",STR_SUCCESS="success",STR_TIMEOUT="timeout",win=window,Deferred=$.Deferred,head=$("head")[0]||document.documentElement,pageCache={},count=0,lastValue,xOptionsDefaults={callback:STR_JQUERY_JSONP,url:location.href},opera=win.opera;function jsonp(xOptions){xOptions=$.extend({},xOptionsDefaults,xOptions);var successCallback=xOptions.success,errorCallback=xOptions.error,completeCallback=xOptions.complete,dataFilter=xOptions.dataFilter,callbackParameter=xOptions.callbackParameter,successCallbackName=xOptions.callback,cacheFlag=xOptions.cache,pageCacheFlag=xOptions.pageCache,charset=xOptions.charset,url=xOptions.url,data=xOptions.data,timeout=xOptions.timeout,pageCached,done=0,cleanUp=noop,supportOnload,supportOnreadystatechange,firstChild,script,scriptAfter,timeoutTimer;Deferred&&Deferred(function(defer){defer.done(successCallback).fail(errorCallback);successCallback=defer.resolve;errorCallback=defer.reject}).promise(xOptions);xOptions.abort=function(){!(done++)&&cleanUp()};if(callIfDefined(xOptions.beforeSend,xOptions,[xOptions])===!1||done){return xOptions}url=url||STR_EMPTY;data=data?((typeof data)=="string"?data:$.param(data,xOptions.traditional)):STR_EMPTY;url+=data?(qMarkOrAmp(url)+data):STR_EMPTY;callbackParameter&&(url+=qMarkOrAmp(url)+encodeURIComponent(callbackParameter)+"=?");!cacheFlag&&!pageCacheFlag&&(url+=qMarkOrAmp(url)+"_"+(new Date()).getTime()+"=");url=url.replace(/=\?(&|$)/,"="+successCallbackName+"$1");function notifySuccess(json){if(!(done++)){cleanUp();pageCacheFlag&&(pageCache[url]={s:[json]});dataFilter&&(json=dataFilter.apply(xOptions,[json]));callIfDefined(successCallback,xOptions,[json,STR_SUCCESS]);callIfDefined(completeCallback,xOptions,[xOptions,STR_SUCCESS])}}function notifyError(type){if(!(done++)){cleanUp();pageCacheFlag&&type!=STR_TIMEOUT&&(pageCache[url]=type);callIfDefined(errorCallback,xOptions,[xOptions,type]);callIfDefined(completeCallback,xOptions,[xOptions,type])}}if(pageCacheFlag&&(pageCached=pageCache[url])){pageCached.s?notifySuccess(pageCached.s[0]):notifyError(pageCached)}else{win[successCallbackName]=genericCallback;script=$(STR_SCRIPT_TAG)[0];script.id=STR_JQUERY_JSONP+count++;if(charset){script[STR_CHARSET]=charset}opera&&opera.version()<11.6?((scriptAfter=$(STR_SCRIPT_TAG)[0]).text="document.getElementById('"+script.id+"')."+STR_ON_ERROR+"()"):(script[STR_ASYNC]=STR_ASYNC);if(STR_ON_READY_STATE_CHANGE in script){script.htmlFor=script.id;script.event=STR_ON_CLICK}script[STR_ON_LOAD]=script[STR_ON_ERROR]=script[STR_ON_READY_STATE_CHANGE]=function(result){if(!script[STR_READY_STATE]||!/i/.test(script[STR_READY_STATE])){try{script[STR_ON_CLICK]&&script[STR_ON_CLICK]()}catch(_){}result=lastValue;lastValue=0;result?notifySuccess(result[0]):notifyError(STR_ERROR)}};script.src=url;cleanUp=function(i){timeoutTimer&&clearTimeout(timeoutTimer);script[STR_ON_READY_STATE_CHANGE]=script[STR_ON_LOAD]=script[STR_ON_ERROR]=null;head[STR_REMOVE_CHILD](script);scriptAfter&&head[STR_REMOVE_CHILD](scriptAfter)};head[STR_INSERT_BEFORE](script,(firstChild=head.firstChild));scriptAfter&&head[STR_INSERT_BEFORE](scriptAfter,firstChild);timeoutTimer=timeout>0&&setTimeout(function(){notifyError(STR_TIMEOUT)},timeout)}return xOptions}jsonp.setup=function(xOptions){$.extend(xOptionsDefaults,xOptions)};$.jsonp=jsonp})(jQuery);

(function(root){var CIM=root.CIM;CIM.utils.denullAndTrim=function(obj,newval){if(_.isArray(obj)){_(obj).each(function(item){CIM.utils.denullAndTrim(item,newval)})}else{if($jq.isPlainObject(obj)){_.each(_.keys(obj),function(key){if(_.isNull(obj[key])){obj[key]=newval}else{if(_.isString(obj[key])){obj[key]=obj[key].trim();if(obj[key].length===0){obj[key]=newval}}else{if($jq.isArray(obj[key])){_.each(obj[key],function(item){CIM.utils.denullAndTrim(item,newval)})}else{if($jq.isPlainObject(obj[key])){CIM.utils.denullAndTrim(obj[key],newval)}}}}})}}};CIM.utils.toObjectArray=function(data,keys){var i,instance;if(_.isArray(data)==false||_.isArray(keys)==false){return null}return _.reduce(data,function(collection,item){instance={};for(i=0;i<keys.length;i++){if(i+1>item.length){break}instance[keys[i]]=item[i]}collection.push(instance);return collection},[])};CIM.utils.toArray=function(value){if(_.isArray(value)){return value}else{if(_.isUndefined(value)||_.isNull(value)){return[]}else{return[value]}}};CIM.utils.toBoolean=function(value){if(_.isBoolean(value)){return value}else{if(_.isString(value)){switch(value.toLowerCase()){case"true":case"yes":case"t":case"y":case"1":return true;case"false":case"no":case"f":case"n":case"0":case null:return false;default:return Boolean(value)}}else{return value}}};CIM.utils.getViewOptions=function(options,model){var result={};if(_.isObject(options)){result=_.extend({},options)}result=_.defaults(result,{model:model});return result};CIM.utils.render=function(viewType,viewOptions,viewContainer){var view;view=new viewType(viewOptions);view=view.render();if(_.isUndefined(viewContainer)===false){if(_.has(viewContainer,"$el")){viewContainer.$el.append(view.$el)}else{viewContainer.append(view.$el)}return viewContainer}else{return view}};CIM.utils.openURL=function(url,inTab){if(inTab===true){window.open(url)}else{window.location=url}};CIM.utils.setContacts=function(cimInfo,contacts){var set=function(attribute,role){var rp;if(_.isUndefined(cimInfo[attribute])){rp=_.find(contacts,function(rp){return rp.role===role});if(!_.isUndefined(rp)){cimInfo[attribute]=rp.organisationName}else{cimInfo[attribute]=CIM.utils.constants.ui.NULL_FIELD}}};set("institute","centre");set("funder","funder")};CIM.utils.remove=function(collection,key,values){return _.filter(collection,function(instance){return _.has(instance,key)&&_.indexOf(values,instance[key])===-1})};CIM.utils.applyCSS=function(view,targets){_.each(targets,function(target){_.each(target[1],function(selector){view.$(selector).addClass(this[0])},target)})}})(this||window);

(function(root){var CIM=root.CIM;CIM.utils.schemas={supported:[{version:"1.5",types:[{name:"cIM_Quality",shortName:"quality",displayName:"Quality",pkg:"quality"},{name:"dataObject",shortName:"data",displayName:"Data",pkg:"data"},{name:"ensemble",shortName:"ensemble",displayName:"Ensemble",pkg:"activity"},{name:"gridSpec",shortName:"grid",displayName:"Grid",pkg:"grids"},{name:"modelComponent",shortName:"model",displayName:"Model",pkg:"software"},{name:"numericalExperiment",shortName:"experiment",displayName:"Experiment",pkg:"activity"},{name:"platform",shortName:"platform",displayName:"Platform",pkg:"shared"},{name:"simulationRun",shortName:"simulation",displayName:"Simulation",pkg:"activity"}]}],isSupportedSchema:function(schema){return _.isUndefined(_.find(this.supported,function(s){return s.version===schema}))===false},getSchema:function(schema){return _.find(this.supported,function(s){return s.version===schema})},isSupportedType:function(schema,type){if(this.isSupportedSchema(schema)===false){return false}schema=this.getSchema(schema);if(_.isUndefined(_.find(schema.types,function(t){return t.name===type||t.shortName===type}))){return false}return true},getType:function(schema,type){var result;if(this.isSupportedType(schema,type)){result=_.find(this.getSchema(schema).types,function(t){return t.name===type||t.shortName===type})}return result},getSchemaInfo:function(version){return _.find(this.supported,function(schema){return schema.version===version})},getPackageInfo:function(version,pkgName){var schema;schema=this.getSchemaInfo(version);if(_.isUndefined(schema)===false){return _.find(schema.packages,function(pkg){return pkg.name===pkgName})}return undefined},getTypeInfo:function(version,pkgName,typeName){var pkg;pkg=this.getPackageInfo(version,pkgName);if(_.isUndefined(pkg)===false){return _.find(pkg.types,function(type){return type.name===typeName})}return undefined}}})(this||window);

(function(root){var CIM=root.CIM,that={};var setError=function(errors,msg){if(_.isUndefined(errors)){errors=[]}if(_.isArray(errors)){errors.push(msg)}else{errors=[errors];errors.push(msg)}};var are=function(fields,errors,validator){if(fields){_.each(fields,function(field){validator(field[0],field[1],errors)})}};that.isRequired=function(value,name,errors){var isValid;var msg;isValid=!_.isUndefined(value);if(!isValid){msg="Parameter {{0}} is required";msg=msg.replace("{0}",name);setError(errors,msg)}return isValid};that.areRequired=function(obj,fields,errors){var msg="Parameter {{0}} is required";_.each(fields,function(field){if(_.has(obj,field)===false){setError(errors,msg.replace("{0}",field))}})};that.isString=function(value,name,errors){var isValid;var msg;isValid=_.isString(value)&&$jq.trim(value).length>0;if(!isValid){msg="Parameter {{0}} must be a string";msg=msg.replace("{0}",name);setError(errors,msg)}return isValid};that.areStrings=function(obj,fields,errors){var msg="Parameter {{0}} must be a string";_.each(fields,function(field){if(_.has(obj,field)&&_.isString(obj[field])===false){setError(errors,msg.replace("{0}",field))}})};that.isPlainObject=function(value,name,errors){var isValid;var msg;isValid=$jq.isPlainObject(value);if(!isValid){msg="Parameter {{0}} must be a hash of key/value pairs";msg=msg.replace("{0}",name);setError(errors,msg)}return isValid};that.arePlainObjects=function(fields,errors){are(fields,errors,that.isPlainObject)};that.isCIMType=function(schema,type,errors){var isValid,msg;isValid=CIM.utils.schemas.isSupportedType(schema,type);if(!isValid){msg="Invalid cim document type :: {0} (schema = v{1}).";msg=msg.replace("{0}",type);msg=msg.replace("{1}",schema);setError(errors,msg)}return isValid};CIM.utils.validation=that})(this||window);

(function(root){var CIM=root.cim;CIM.api={events:_.extend({},Backbone.Events)};CIM.api.getByExternalID=function(params){var query={};query.name="getByExternalID";query.validateParams=function(){var errors=[],fields=["externalID","externalType","project","schema","language"];if(CIM.utils.validation.isPlainObject(params,"params",errors)==true){CIM.utils.validation.areRequired(params,fields,errors);CIM.utils.validation.areStrings(params,fields,errors)}if(errors.length>0){CIM.api.events.trigger("error",errors)}return errors.length===0};query.getURL=function(){var url;url=CIM.api.utils.getURL(CIM.api.constants.query.DOC_BY_EXTERNAL_ID);url=CIM.api.utils.appendURLPart(url,params.project);url=CIM.api.utils.appendURLPart(url,params.externalType);url=CIM.api.utils.appendURLPart(url,params.externalID);return url};query.getURLParams=function(){return{encoding:"json",language:params.language,schema:params.schema}};CIM.api.utils.doQuery(params,query)};CIM.api.getByDRS=function(params){var query={};query.name="getByDRS";query.validateParams=function(){var errors=[],fields=["drsPath","schema","language"];if(CIM.utils.validation.isPlainObject(params,"params",errors)==true){CIM.utils.validation.areRequired(params,fields,errors);CIM.utils.validation.areStrings(params,fields,errors)}if(errors.length>0){CIM.api.events.trigger("error",errors)}return errors.length===0};query.parseParams=function(){if(_.has(params,"drsKeys")===false){params.drsKeys=_.without(params.drsPath.split("/"),"")}params.drsPath=_.reduce(params.drsKeys,function(path,key){return path+"/"+$jq.trim(key).toUpperCase()},"")};query.getURL=function(){var url;url=CIM.api.utils.getURL(CIM.api.constants.query.DOC_BY_DRS);url+=params.drsPath;return url};query.getURLParams=function(){return{encoding:"json",language:params.language,schema:params.schema}};CIM.api.utils.doQuery(params,query)};CIM.api.getByName=function(params){var query={};query.name="getByName";query.validateParams=function(){var errors=[],fields=["project","type","name","schema","language"];if(CIM.utils.validation.isPlainObject(params,"params",errors)==true){CIM.utils.validation.areRequired(params,fields,errors);if(_.has(params,"institute")){fields.push("institute")}CIM.utils.validation.areStrings(params,fields,errors);if(errors.length===0){CIM.utils.validation.isCIMType(params.schema,params.type,errors)}}if(errors.length>0){CIM.api.events.trigger("error",errors)}return errors.length===0};query.parseParams=function(){params.type=CIM.utils.schemas.getType(params.schema,params.type).name;params.type=params.type.toUpperCase();params.name=$jq.trim(params.name);params.name=params.name.toUpperCase()};query.getURL=function(){var url;url=CIM.api.utils.getURL(CIM.api.constants.query.DOC_BY_NAME);url=CIM.api.utils.appendURLPart(url,params.project);url=CIM.api.utils.appendURLPart(url,params.type);url=CIM.api.utils.appendURLPart(url,params.name);url=CIM.api.utils.appendURLPart(url,params.institute);return url};query.getURLParams=function(){return{encoding:"json",language:params.language,schema:params.schema}};CIM.api.utils.doQuery(params,query)};CIM.api.getByID=function(params){var query={};query.name="getByID";query.validateParams=function(){var errors=[],fields=["id","project","schema","language"];if(CIM.utils.validation.isPlainObject(params,"params",errors)==true){CIM.utils.validation.areRequired(params,fields,errors);if(_.has(params,"version")){fields.push("version")}CIM.utils.validation.areStrings(params,fields,errors)}if(errors.length>0){CIM.api.events.trigger("error",errors)}return errors.length===0};query.getURL=function(){var url;url=CIM.api.utils.getURL(CIM.api.constants.query.DOC_BY_ID);url=CIM.api.utils.appendURLPart(url,params.project);url=CIM.api.utils.appendURLPart(url,params.id);url=CIM.api.utils.appendURLPart(url,params.version);return url};query.getURLParams=function(){return{encoding:"json",language:params.language,schema:params.schema}};CIM.api.utils.doQuery(params,query)}})(this||window);

(function(root){var CIM=root.CIM;CIM.api.constants={getBaseURL:function(){var url;if(CIM.options.usePURL===true){url="http://purl.org/org/es-doc/api/{MODE}"}else{if(CIM.options.mode==="dev"){url="http://127.0.0.1:5000"}else{url="http://{MODE}.api.esdoc.webfactional.com"}}url=url.replace("{MODE}",CIM.options.mode);return url},query:{DOC_BY_DRS:"/1/query/documentByDRS",DOC_BY_EXTERNAL_ID:"/1/query/documentByExternalID",DOC_BY_ID:"/1/query/documentByID",DOC_BY_NAME:"/1/query/documentByName"},http:{JSONP_CALLBACK_FN:"onJSONPLoad",JSONP_TIMEOUT:10000}}})(this||window);

(function(root){var CIM=root.CIM;CIM.api.events.on("error",function(err){var error;error={type:"API",errors:[err]};CIM.events.trigger("global:error",error)});CIM.api.events.on("webServiceError",function(service,operation,exception){var error,err;err="An error occurred when invoking CIM web service:\n";err+="\tService\t: "+service+"\n";err+="\tOperation\t: "+operation+"\n";err+="\tError\t\t: "+exception.message+"\n";error={type:"API",errors:[err]};CIM.events.trigger("global:error",error)})})(this||window);

(function(root){var CIM=root.cim;CIM.api.utils={};CIM.api.utils.appendURLPart=function(url,value){if(!_.isUndefined(value)){value=value.trim();if(value.length>0){url+="/"+value}}return url};CIM.api.utils.getURL=function(url){return CIM.api.constants.getBaseURL()+url};CIM.api.utils.doQuery=function(params,query){var parseParams,validateParams,invokeAPI,onAPISuccess,onAPIError;parseParams=function(){params.project=$jq.trim(params.project);params.project=params.project.toUpperCase();_.defaults(params,{schema:CIM.options.documentSchema,language:CIM.options.documentLanguage})};validateParams=function(){return true};onAPISuccess=function(documentSet){CIM.api.events.trigger("documentSetLoaded",documentSet)};onAPIError=function(xOptions,textStatus){var error;error={type:"API",errors:[]};if(textStatus==="timeout"){error.errors.push("CIM API request timed out - if this problem continues please contact your system administrator.")}else{error.errors.push("A CIM API error occurred - please contact your system administrator.")}CIM.events.trigger("global:error",error)};invokeAPI=function(){try{$jq.jsonp({url:query.getURL(),data:query.getURLParams(),dataFilter:CIM.api.utils.parseDocumentSet,callbackParameter:CIM.api.constants.http.JSONP_CALLBACK_FN,pageCache:true,success:onAPISuccess,timeout:CIM.api.constants.http.JSONP_TIMEOUT,error:onAPIError})}catch(exception){CIM.api.events.trigger("webServiceError","query",query.name,exception);return}};try{if(validateParams()===true&&query.validateParams()===true){parseParams();if(_.isFunction(query.parseParams)){query.parseParams()}invokeAPI()}}catch(exception){CIM.api.events.trigger("error","query",query.name,exception)}};var parseDocumentSetPhase1=function(documentSet){var documentGroups;documentSet=_.map(CIM.utils.toArray(documentSet),function(document){return _.isObject(document)?document:JSON.parse(document)});documentSet=_.filter(documentSet,function(document){return(_.has(document,"cimInfo")&&_.has(document.cimInfo,"typeInfo")&&_.has(document.cimInfo.typeInfo,"schema")&&_.has(document.cimInfo.typeInfo,"package")&&_.has(document.cimInfo.typeInfo,"type")&&_.has(document.cimInfo.typeInfo,"typeDisplayName"))});_.each(documentSet,function(document){document.cimInfo.typeInfo.pkg=document.cimInfo.typeInfo["package"];document.cimInfo.key=document.cimInfo.project;document.cimInfo.key+="_";document.cimInfo.key+=document.cimInfo.id;document.cimInfo.key+="_";document.cimInfo.key+=document.cimInfo.version;document.cimTypeInfo=document.cimInfo.typeInfo;document.cimTypeInfo.key=document.cimInfo.typeInfo.schema;document.cimTypeInfo.key+="-";document.cimTypeInfo.key+=document.cimInfo.typeInfo.pkg;document.cimTypeInfo.key+="-";document.cimTypeInfo.key+=document.cimInfo.typeInfo.type;document.cimDisplayTitle=document.cimInfo.project.toUpperCase();document.cimDisplayTitle+=" ";document.cimDisplayTitle+=document.cimInfo.typeInfo.typeDisplayName;document.cimDisplayTitle+=" - ";document.cimDisplayTitle+=document.shortName;document.cimDisplayTitle+=" (v";document.cimDisplayTitle+=document.cimInfo.version;document.cimDisplayTitle+=")"});documentGroups=_.groupBy(documentSet,function(document){return document.cimTypeInfo.key});documentGroups=_.reduce(documentGroups,function(groups,documents){groups.push({typeKey:documents[0].cimTypeInfo.key,displayTitle:documents[0].cimTypeInfo.typeDisplayName,documentSet:documents});return groups},[]);return{all:documentSet,groups:{all:documentGroups}}};var parseDocumentSetPhase2=function(documentSet){return documentSet};CIM.api.utils.parseDocumentSet=function(documentSet){documentSet=parseDocumentSetPhase1(documentSet);documentSet=parseDocumentSetPhase2(documentSet);return documentSet}})(this||window);

(function(root){var CIM=root.cim;CIM.viewer={events:_.extend({},Backbone.Events),views:{v1:{activity:{},data:{},grids:{},quality:{},shared:{},software:{}},viewport:{}}};CIM.viewer.renderFromDRS=function(params){var validateParams,parseParams;validateParams=function(){var errors=[],fields=["drsPath","project","schema","language"];if(CIM.utils.validation.isPlainObject(params,"params",errors)==true){CIM.utils.validation.areRequired(params,fields,errors);CIM.utils.validation.areStrings(params,fields,errors)}if(errors.length>0){CIM.viewer.events.trigger("error",errors)}return errors.length===0};parseParams=function(){_.defaults(params,{schema:CIM.options.documentSchema,language:CIM.options.documentLanguage})};parseParams();if(validateParams()===true){CIM.api.getByDRS(params)}};CIM.viewer.renderFromExternalID=function(params){var validateParams,parseParams;validateParams=function(){var errors=[],fields=["externalID","externalType","project","schema","language"];if(CIM.utils.validation.isPlainObject(params,"params",errors)==true){CIM.utils.validation.areRequired(params,fields,errors);CIM.utils.validation.areStrings(params,fields,errors)}if(errors.length>0){CIM.viewer.events.trigger("error",errors)}return errors.length===0};parseParams=function(){_.defaults(params,{schema:CIM.options.documentSchema,language:CIM.options.documentLanguage})};parseParams();if(validateParams()===true){CIM.api.getByExternalID(params)}};CIM.viewer.renderFromName=function(params){var validateParams,parseParams;validateParams=function(){var errors=[],fields=["type","name","project","schema","language"];if(CIM.utils.validation.isPlainObject(params,"params",errors)==true){CIM.utils.validation.areRequired(params,fields,errors);if(_.has(params,"institute")){fields.push("institute")}CIM.utils.validation.areStrings(params,fields,errors);if(errors.length===0){CIM.utils.validation.isCIMType(params.schema,params.type,errors)}}if(errors.length>0){CIM.viewer.events.trigger("error",errors)}return errors.length===0};parseParams=function(){_.defaults(params,{schema:CIM.options.documentSchema,language:CIM.options.documentLanguage})};parseParams();if(validateParams()===true){CIM.api.getByName(params)}};CIM.viewer.renderFromID=function(params){var validateParams,parseParams;validateParams=function(){var errors=[],fields=["id","project","schema","language"];if(CIM.utils.validation.isPlainObject(params,"params",errors)==true){CIM.utils.validation.areRequired(params,fields,errors);if(_.has(params,"version")){fields.push("version")}CIM.utils.validation.areStrings(params,fields,errors)}if(errors.length>0){CIM.viewer.events.trigger("error",errors)}return errors.length===0};parseParams=function(){_.defaults(params,{schema:CIM.options.documentSchema,language:CIM.options.documentLanguage})};parseParams();if(validateParams()===true){CIM.api.getByID(params)}}})(this||window);

(function(root){var CIM=root.cim;var my={messages:{emptyDocumentSet:"No CIM metadata can be found at this time."}};CIM.viewer.events.on("exception",function(exception){var error;error={type:"Viewer",errors:[exception.message]};CIM.events.trigger("global:error",error)});CIM.viewer.events.on("error",function(errors){var error;error={type:"Viewer",errors:errors};CIM.events.trigger("global:error",error)});CIM.api.events.on("documentSetLoaded",function(documentSet){var DocumentView=CIM.viewer.views.DocumentView;try{documentSet.groups.renderable=documentSet.groups.all.filter(function(group){return DocumentView.isSupported(group.typeKey)});if(documentSet.groups.renderable.length){CIM.utils.denullAndTrim(documentSet.all,CIM.utils.constants.ui.NULL_FIELD);_.each(documentSet.groups.renderable,function(group){group.view=DocumentView.getView(group.typeKey)});documentSet.groups.renderable=_.sortBy(documentSet.groups.renderable,function(group){return group.view.renderPriority});CIM.viewer.events.trigger("render",documentSet)}else{CIM.events.trigger("message:information",my.messages.emptyDocumentSet)}}catch(exception){CIM.viewer.events.trigger("exception",exception)}});CIM.viewer.events.on("render",function(documentSet){var viewPortOptions,viewPort,dialog,group;viewPortOptions={model:{documents:documentSet.all,groups:documentSet.groups.renderable}};viewPort=new CIM.viewer.views.DocumentViewport(viewPortOptions);dialog=new CIM.views.utils.Dialog({onClose:function(){viewPort.destroy()}});CIM.viewer.events.on("documentSelected",function(document){dialog.setTitle(document.cimDisplayTitle)});dialog.render();dialog.$el.append(viewPort.render().$el);group=documentSet.groups.renderable[0];CIM.viewer.events.trigger("documentGroupSelected",group);if(documentSet.groups.renderable.length===1){CIM.viewer.events.trigger("documentSelected",group.documentSet[0])}dialog.open()})})(this||window);

(function(root){var CIM=root.CIM,View;View=Backbone.View.extend({render:function(){var me=this;this.$el.dialog({bgiframe:false,autoOpen:false,height:"auto",width:"1000",position:["center",100],modal:true,resizable:false,close:function(){if(_.isUndefined(me.options.onClose)===false&&_.isFunction(me.options.onClose)){me.options.onClose()}me.remove();me.$el.dialog("destroy")}});return this},append:function(el){this.$el.append(el)},open:function(){this.$el.dialog("open")},setTitle:function(caption){var title="";title=CIM.utils.constants.app.getCaption();if(_.isUndefined(caption)===false){title+=" | ";title+=caption}this.$el.dialog("option","title",title)}});CIM.views.utils.Dialog=View})(this||window);

(function(root){var CIM=root.CIM,MESSAGE_TYPE_INFORMATION=1,MESSAGE_TYPE_CONFIRMATION=2,MESSAGE_TYPE_PROGRESS=3,MESSAGE_TYPE_HELP=4,MESSAGE_TYPE_WARNING=90,MESSAGE_TYPE_ERROR=99,STANDARD_MESSAGE_UNKNOWN="Unknown message",STANDARD_MESSAGE_ERROR="A processing error has occurred ... please contact the system administrator.",getTypeName,getClassName,getIconClassName,getTextClassName,View;getTypeName=function(type){if(type===MESSAGE_TYPE_INFORMATION){return"information"}else{if(type===MESSAGE_TYPE_CONFIRMATION){return"confirmation"}else{if(type===MESSAGE_TYPE_HELP){return"help"}else{if(type===MESSAGE_TYPE_WARNING){return"warning"}else{if(type===MESSAGE_TYPE_ERROR){return"error"}else{return"information"}}}}}};getClassName=function(type){var typeName=getTypeName(type);return"cim-message cim-message-"+typeName};getIconClassName=function(type){var typeName=getTypeName(type);return"cim-message-icon cim-message-icon-"+typeName};getTextClassName=function(type){var typeName=getTypeName(type);return"cim-message-text cim-message-text-"+typeName};View=Backbone.View.extend({$make:function(tag,atts,text){return $jq(this.make(tag,atts,text))},_setup:function(type){var text,icon;this.className=getClassName(type);icon=this.$make("div",{"class":getIconClassName(type)});this.$el.append(icon);text=this.$make("div",{"class":getTextClassName(type)});this.$el.append(text)},_setText:function(type,text){if(_.isUndefined(text)){if(type===MESSAGE_TYPE_ERROR){text=STANDARD_MESSAGE_ERROR}else{text=STANDARD_MESSAGE_UNKNOWN}}this.$(".cim-message-text").html(text)},_setTitle:function(type,caption){var title="";if(_.isString(caption)===true){if(caption.startsWith(CIM.utils.constants.app.getCaption())===true){title=caption}else{title=CIM.utils.constants.app.getCaption();title+=" - ";title+=caption}}else{title=CIM.utils.constants.app.getCaption()}this.$el.attr("title",title)},destroy:function(){this.$el.dialog("close");this.$el.dialog("destroy");this.remove()},_createConfig:function(type,continuation){var view=this,config;config={width:380,position:["center",150],modal:true};if(type===MESSAGE_TYPE_INFORMATION||type===MESSAGE_TYPE_HELP||type===MESSAGE_TYPE_WARNING||type===MESSAGE_TYPE_ERROR){_.extend(config,{buttons:{OK:function(){view.destroy();if(_.isFunction(continuation)){continuation()}}}})}if(type===MESSAGE_TYPE_CONFIRMATION){_.extend(config,{Yes:function(){view.destroy();if(_.isFunction(continuation)){continuation()}},No:function(){view.destroy()}})}return config},render:function(type,text,caption,continuation){this._setup(type);this._setText(type,text);this._setTitle(type,caption);this.$el.dialog(this._createConfig(type,continuation));return this}});CIM.events.on("message:confirmation",function(text,caption,continuation){new View().render(MESSAGE_TYPE_CONFIRMATION,text,caption,continuation)});CIM.events.on("message:error",function(text,caption,continuation){new View().render(MESSAGE_TYPE_ERROR,text,caption,continuation)});CIM.events.on("message:help",function(text,caption,continuation){new View().render(MESSAGE_TYPE_HELP,text,caption,continuation)});CIM.events.on("message:information",function(text,caption,continuation){new View().render(MESSAGE_TYPE_INFORMATION,text,caption,continuation)});CIM.events.on("message:warning",function(text,caption,continuation){new View().render(MESSAGE_TYPE_WARNING,text,caption,continuation)})})(this||window);

(function(root){var CIM=root.CIM;var my={templates:{item:{html:"\n                    <div class='cim-field-caption'>\n                        <p title='{caption}'>{caption}</p>\n                    </div>\n                    <div class='cim-field-expression'>\n                        <p class='{css}'><%- {expression} %></p>\n                    </div>\n                    <div class='cim-field-spacer'></div>",template:_.template("\n                    <div class='cim-field-name' title='<%= caption %>'>\n                        <p><%= caption %></p>\n                    </div>\n                    <div class='cim-field-value' title='<%= value %>'>\n                        <p class='{css}'><%= value %></p>\n                    </div>\n                    <div class='cim-field-spacer'></div>"),create:function(field,modelCSS){var html,css;if(_.has(field,"value")){return my.templates.item.template}else{html=my.templates.item.html;html=html.replace(/{caption}/g,field.caption.trim());html=html.replace(/{expression}/g,field.expression.trim());css="";if(!_.isUndefined(modelCSS)){css=modelCSS.trim();css+="-";css+=field.expression.trim().replace(".","-")}html=html.replace(/{css}/g,css);return _.template(html)}}},group:{caption:_.template("\n                    <div class='cim-field-group-caption' title='<%= caption %>'>\n                        <%= caption %>\n                    </div>")}},CSS:{setModelCSS:function(view,cssSuffix){if(_.has(view.options,"modelCSS")&&!_.isUndefined(view.options.modelCSS)){view.$el.addClass(view.options.modelCSS+cssSuffix)}}}};var GroupSetView=Backbone.View.extend({className:"cim-field-group-set",render:function(){var subViewType,subViewOptions;this.model=CIM.utils.toArray(this.model);_.each(this.model,function(group){subViewType=CIM.views.utils.field.Group;subViewOptions=_.extend(this.options,{model:group});CIM.utils.render(subViewType,subViewOptions,this)},this);my.CSS.setModelCSS(this,"-field-group-set");return this}});var GroupView=Backbone.View.extend({className:"cim-field-group",render:function(){var template,subViewType,subViewOptions;template=my.templates.group.caption;this.$el.append(template(this.model));subViewType=CIM.views.utils.field.ItemSet;subViewOptions=_.extend(this.options,{model:undefined,fieldSet:this.model.fieldSet});CIM.utils.render(subViewType,subViewOptions,this);my.CSS.setModelCSS(this,"-field-group");return this}});var ListView=Backbone.View.extend({className:"cim-field-set-list",render:function(){var subViewOptions,subView;subViewOptions=_.extend(this.options,{modelViewType:CIM.views.utils.field.ItemSet,CSS:this.className});subView=new CIM.views.utils.List(subViewOptions);this.$el=subView.render().$el;my.CSS.setModelCSS(this,"-field-set-list");return this}});var ItemSetView=Backbone.View.extend({className:"cim-field-set cim-content-block",render:function(){var fieldSet,subViewType,subViewOptions;fieldSet=this._getFieldSet(this.options,this.model);subViewType=CIM.views.utils.field.Item;_.each(fieldSet,function(field){subViewOptions={model:this.model,modelCSS:this.options.modelCSS,field:field};CIM.utils.render(subViewType,subViewOptions,this)},this);my.CSS.setModelCSS(this,"-field-set");return this},_getFieldSet:function(options,model){if(_.has(options,"fieldSet")&&!_.isUndefined(options.fieldSet)){return options.fieldSet}else{if(_.has(options,"fieldSetFactory")&&!_.isUndefined(options.fieldSetFactory)){return CIM.utils.toObjectArray(options.fieldSetFactory(model),["caption","expression"])}else{return[]}}}});var ItemView=Backbone.View.extend({className:"cim-field cim-content-item",render:function(){var template;template=my.templates.item.create(this.options.field,this.options.modelCSS);if(_.isUndefined(this.model)&&_.has(this.options.field,"value")){this.$el.append(template(this.options.field))}else{this.$el.append(template(this.model))}return this}});CIM.views.utils.field={GroupSet:GroupSetView,Group:GroupView,List:ListView,ItemSet:ItemSetView,Item:ItemView}})(this||window);

(function(root){var CIM=root.CIM;var GroupHeaderView=Backbone.View.extend({className:"cim-group-header",render:function(){this.$el.text(this.options.group.title);return this}});var GroupView=Backbone.View.extend({className:"cim-group",render:function(){var viewOptions;viewOptions={group:this.options.group,model:this.model};CIM.utils.render(GroupHeaderView,viewOptions,this);viewOptions={CSS:"cim-group-content",model:this.model,modelViewType:this.options.modelViewType,modelViewCSS:"cim-group-content-item",modelSortField:this.options.modelSortField};CIM.utils.render(CIM.views.utils.List,viewOptions,this);return this}});var GroupSetView=Backbone.View.extend({className:"cim-group-set",render:function(){var groupSet,viewOptions;if(_.has(this.options,"modelCSS")){this.$el.addClass(this.options.modelCSS+"-group")}this.model=CIM.utils.toArray(this.model);groupSet=this._getGroupSet(this.options,this.model);if(_.has(this.options,"groupSetSortField")&&_.isUndefined(this.options.groupSetSortField)===false){groupSet=_.sortBy(groupSet,this.options.groupSetSortField)}_.each(groupSet,function(group){group.model=_.filter(this.model,function(model){return model[this.options.groupingField]===group.key},this)},this);groupSet=_.filter(groupSet,function(group){return group.model.length>0});_.each(groupSet,function(group){viewOptions={group:group,model:group.model,modelViewType:this.options.modelViewType,modelViewOptions:this.options.modelViewOptions,modelSortField:this.options.groupingSortField};CIM.utils.render(GroupView,viewOptions,this)},this);return this},_getGroupSet:function(options,model){if(_.has(options,"groupSet")&&!_.isUndefined(options.groupSet)){return options.groupSet}else{if(_.has(options,"groupSetFactory")&&!_.isUndefined(options.groupSetFactory)){return options.groupSetFactory(model)}else{return[]}}}});CIM.views.utils.group={GroupSet:GroupSetView,Group:GroupView}})(this||window);

(function(root){var CIM=root.CIM,ListView;ListView=Backbone.View.extend({render:function(){var view,viewOptions;if(_.has(this.options,"model")===false){CIM.events.triggerError("View","Required view option: ListView.model");return this}if(!_.has(this.options,"modelViewType")&&!_.has(this.options,"modelViewFactory")){CIM.events.triggerError("View","Required view option: One of ListView.modelViewType or ListView.modelViewFactory");return this}if(_.has(this.options,"CSS")&&_.isUndefined(this.options.CSS)===false){this.$el.addClass(this.options.CSS)}if(_.has(this.options,"modelCSS")&&_.isUndefined(this.options.modelCSS)===false){this.$el.addClass(this.options.modelCSS+"-list")}this.model=CIM.utils.toArray(this.model);if(this.model.length>1&&_.has(this.options,"modelSortField")&&_.isUndefined(this.options.modelSortField)===false){this.model=_.sortBy(this.model,function(m){return m[this.options.modelSortField].toUpperCase()},this)}_.each(this.model,function(item){viewOptions=_.defaults({model:item,CSS:this.options.modelViewCSS},this.options);if(_.has(this.options,"modelViewType")){CIM.utils.render(this.options.modelViewType,viewOptions,this)}else{this.$el.append(this.options.modelViewFactory(item).$el)}},this);return this}});CIM.views.utils.List=ListView})(this||window);

(function(root){var CIM=root.CIM,TabSetView;TabSetView=Backbone.View.extend({className:"cim-tabbed-view",render:function(){switch(CIM.options.uiFramework){case CIM.utils.constants.ui.frameworks.JQUERY:this._renderJQuery();break;default:break}return this},_renderJQuery:function(){var $ul,view=this;$ul=$jq(view.make("ul"));_.each(this.options.tabset,function(tab){$ul.append($jq(this.make("li",{})).append($jq(this.make("a",{href:"#"+tab.id,"class":tab.CSS===undefined?"cim-tab-button":tab.CSS},tab.caption))))},this);this.options.$contentWrapper.append(this.$el);this.$el.append($ul);this.$el.append(this.options.$content);this.$el.tabs({fx:{opacity:"toggle"}});return this}});CIM.views.utils.tab={TabSet:TabSetView}})(this||window);

(function(root){var CIM=root.cim;var DocumentView=CIM.viewer.views.DocumentView=Backbone.View.extend({className:"cim-document-outer",render:function(){var documentView,ctx;documentView=this._getDocumentView();ctx={$:this.$,document:this.options.document,documentSet:this.options.documentSet,view:this,sections:documentView.sections,userOptions:documentView.userOptions,make:this.make,$make:function(tagName,attributes,content){return $jq(this.make(tagName,attributes,content))}};this._setDOM(ctx);_.each(this._getTasks(),function(taskInfo){taskInfo.task(ctx)});return this},_getDocumentView:function(){var documentView;documentView=DocumentView.getView(this.options.documentType);documentView.userOptions=_.clone(documentView.defaultOptions);if(CIM.options.showCimInfo===true){documentView.sections.push({key:"cimInfo",caption:"CIM Info",type:CIM.viewer.views.v1.shared.cimInfo.Detail,filterModel:function(document){return document.cimInfo}});documentView.userOptions.sections.push({key:"cimInfo",display:true,mode:"inline"})}return documentView},_setDOM:function(ctx){ctx.$document=$jq(this.make("div",{}));ctx.$document.attr("id",this.options.document.cimInfo.key);ctx.$document.addClass("cim-document");this.$el.append(ctx.$document)},_getTasks:function(){return _.filter(DocumentView.renderingTasks,function(taskInfo){return(taskInfo.uiMode==="all"||taskInfo.uiMode===CIM.options.uiMode)&&(taskInfo.uiFramework==="all"||taskInfo.uiFramework===CIM.options.uiFramework)})}},{views:[],renderingTasks:[],getView:function(documentType){return _.find(this.views,function(view){return view.documentType===documentType})},isSupported:function(documentType){return !_.isUndefined(this.getView(documentType))},register:function(view){if(_.isObject(view)===false||_.has(view,"documentType")===false||_.isString(view.documentType)===false||this.isSupported(view.documentType)||_.has(view,"renderPriority")===false||_.isNumber(view.renderPriority)===false||_.has(view,"defaultOptions")===false||_.isObject(view.defaultOptions)===false||_.has(view,"sections")===false||_.isArray(view.sections)===false){CIM.viewer.events.trigger("exception",{message:"Invalid document view configuration."});return}this.views.push(view)},registerTask:function(task){var taskInfo;taskInfo=_.isFunction(task)?{task:task}:task;if(!_.isObject(taskInfo)||!_.has(taskInfo,"task")){CIM.viewer.events.trigger("exception",{message:"Invalid DocumentView.registerTask parameters"});return}_.defaults(taskInfo,{uiMode:"all",uiFramework:"all"});this.renderingTasks.push(taskInfo)}})})(this||window);

(function(root){var CIM=root.cim,DocumentSectionView;var HeaderView=Backbone.View.extend({className:"cim-document-section-header",render:function(){this.$el.text(this.options.sectionCaption);return this}});var ContentView=Backbone.View.extend({className:"cim-document-section-content",render:function(){CIM.utils.render(this.options.sectionViewType,this.options,this);return this}});CIM.viewer.views.DocumentSectionView=Backbone.View.extend({className:"cim-document-section",initialize:function(){this._subviews=[];if(CIM.options.uiMode===CIM.utils.constants.ui.modes.INLINE){this._subviews.push(new HeaderView(this.options))}this._subviews.push(new ContentView(this.options))},destroy:function(){_.each(this._subviews,function(subview){subview.destroy()})},render:function(){_.each(this._subviews,function(subview){this.$el.append(subview.render().$el)},this);this.$el.attr("id",this.options.sectionID);return this}})})(this||window);

(function(root){var CIM=root.cim,DocumentView=CIM.viewer.views.DocumentView,DocumentSectionView=CIM.viewer.views.DocumentSectionView;DocumentView.registerTask(function(ctx){_.each(ctx.sections,function(section){section.ctx={model:undefined,userOptions:undefined,id:ctx.document.cimInfo.key.replace(".","-")+"-"+section.key};if(_.has(section,"viewOptions")){_.extend(section.ctx,section.viewOptions)}})});DocumentView.registerTask(function(ctx){var isMatch;isMatch=function(opts){return this.key===opts.key};_.each(ctx.sections,function(section){section.ctx.userOptions=_.find(ctx.userOptions.sections,isMatch,section)});_.each(ctx.sections,function(section){if(_.isUndefined(section.ctx.userOptions)){section.ctx.userOptions={}}_.defaults(section.ctx.userOptions,{display:false,key:section.key})})});DocumentView.registerTask(function(ctx){ctx.sections=_.filter(ctx.sections,function(section){return section.ctx.userOptions.display})});DocumentView.registerTask(function(ctx){_.each(ctx.sections,function(section){if(_.has(section,"parseModel")){section.parseModel(ctx.document,ctx.documentSet)}if(_.has(section,"filterModel")){section.ctx.model=section.filterModel(ctx.document,ctx.documentSet)}else{section.ctx.model=ctx.document}})});DocumentView.registerTask(function(ctx){ctx.sections=_.filter(ctx.sections,function(section){if(_.isUndefined(section.ctx.model)){return false}else{if(_.isArray(section.ctx.model)&&section.ctx.model.length===0){return false}}return true})});DocumentView.registerTask(function(ctx){var viewOptions;_.each(ctx.sections,function(section){viewOptions={document:ctx.document,documentSet:ctx.documentSet,model:section.ctx.model,sectionCaption:section.caption,sectionKey:section.key,sectionID:section.ctx.id,sectionViewType:section.viewType,sectionUserOptions:section.ctx.userOptions};if(_.has(section,"viewOptions")){viewOptions=_.extend(viewOptions,section.viewOptions)}CIM.utils.render(DocumentSectionView,viewOptions,ctx.$document)})});DocumentView.registerTask({uiMode:"tabbed",uiFramework:"jquery.ui",task:function(ctx){var tabset,view;tabset=_.map(ctx.sections,function(section){return{caption:section.caption,id:section.ctx.id}});view=new CIM.views.utils.tab.TabSet({$content:ctx.$document,$contentWrapper:ctx.view.$el,tabset:tabset});view.render()}})})(this||window);

(function(root){var CIM=root.cim,DocumentView=CIM.viewer.views.DocumentView;DocumentView.registerTask({uiFramework:"jquery.ui",task:function(ctx){var targets;targets=[["ui-corner-all ui-widget-header",[".cim-document-section-header",]],["ui-corner-all ui-state-highlight",[".footer-outer",".cim-group-header",".cim-field-group-caption"]],["ui-corner-all",[".footer",".cim-field-group-set",".cim-field-group",".cim-field-set-list",".cim-field-set"]]];CIM.utils.applyCSS(ctx.view,targets)}});DocumentView.registerTask(function(ctx){switch(CIM.options.uiMode){case CIM.utils.constants.ui.modes.INLINE:ctx.view.$(".cim-document").addClass("cim-content-scrollable");break;case CIM.utils.constants.ui.modes.TABBED:ctx.view.$(".cim-document-section").addClass("cim-content-scrollable");break;default:break}})})(this||window);

(function(root){var CIM=root.CIM;var my={listSortField:"title",CSS:"cim-v1-activity-ensemble",fieldSetFactory:function(){return[["Type","type"],["Members","memberIDs"],["Short Name","shortName"],["Long Name","longName"],["Description","description"]]}};var ListView=Backbone.View.extend({render:function(){var subView;subView=new CIM.views.utils.field.List({model:this.model,modelCSS:my.CSS,fieldSetFactory:my.fieldSetFactory});this.$el=subView.render().$el;return this}});var DetailView=Backbone.View.extend({render:function(){var fsView;fsView=new CIM.views.utils.field.ItemSet({model:this.model,modelCSS:my.CSS,fieldSetFactory:my.fieldSetFactory});this.$el.append(fsView.render().$el);return this}});CIM.viewer.views.v1.activity.ensemble={List:ListView,Detail:DetailView}})(this||window);

(function(root){var CIM=root.CIM;var my={CSS:"cim-v1-activity-numericalRequirement",fieldSetFactory:function(){return[["Name","name"],["ID","id"],["Description","description"]]},groupSetFactory:function(){return[{title:"Boundary Conditions",key:"boundaryCondition",sortOrder:1},{title:"Initial Conditions",key:"initialCondition",sortOrder:2},{title:"Spatio Temporal Constraints",key:"spatioTemporalConstraint",sortOrder:3},{title:"Output Requirements",key:"outputRequirement",sortOrder:4},]}};var GroupView=Backbone.View.extend({render:function(){var groupSetView;groupSetView=new CIM.views.utils.group.GroupSet({model:this.model,modelViewType:CIM.viewer.views.v1.activity.numericalRequirement.Detail,modelCSS:my.CSS,groupSetFactory:my.groupSetFactory,groupSetSortField:"sortOrder",groupingField:"requirementType",groupingSortField:"name"});this.$el=groupSetView.render().$el;return this}});var ListView=Backbone.View.extend({render:function(){var subView;subView=new CIM.views.utils.field.List({model:this.model,modelCSS:my.CSS,modelSortField:my.listSortField,fieldSetFactory:my.fieldSetFactory});this.$el=subView.render().$el;return this}});var DetailView=Backbone.View.extend({render:function(){var subView;subView=new CIM.views.utils.field.ItemSet({model:this.model,modelCSS:my.CSS,fieldSetFactory:my.fieldSetFactory});this.$el=subView.render().$el;return this}});CIM.viewer.views.v1.activity.numericalRequirement={Group:GroupView,List:ListView,Detail:DetailView}})(this||window);

(function(root){var CIM=root.CIM;var my={CSS:"cim-v1-grids-gridSpec",fieldSetFactory:function(){return[["Short Name","shortName"],["Long Name","longName"],["Mnemonic","mnemonic"],["Type","type"],["Is Leaf","isLeaf"],["Tiles","tileCount"],["Mosaics","mosaicCount"],["Description","description"]]}};var ListView=Backbone.View.extend({render:function(){var subView;subView=new CIM.views.utils.field.List({model:this.model,modelCSS:my.CSS,modelSortField:"shortName",fieldSetFactory:my.fieldSetFactory});this.$el=subView.render().$el;return this}});var DetailView=Backbone.View.extend({render:function(){var subView;subView=new CIM.views.utils.field.ItemSet({model:this.model,modelCSS:my.CSS,fieldSetFactory:my.fieldSetFactory});this.$el=subView.render().$el;return this}});CIM.viewer.views.v1.grids.gridSpec={List:ListView,Detail:DetailView}})(this||window);

(function(root){var CIM=root.CIM;var my={CSS:"cim-v1-quality-report",fieldSetFactory:function(){return[["Report","measure.name"],["ID","measure.identification"],["Evaluator","evaluator.individualName"],["Date","evaluation.date"],["Description","measure.description"],["Passed ?","evaluation.didPass"],["Report","evaluation.explanation"]]}};var ListView=Backbone.View.extend({render:function(){var subView;subView=new CIM.views.utils.field.List({model:this.model,modelCSS:my.CSS,fieldSetFactory:my.fieldSetFactory});this.$el=subView.render().$el;return this}});var DetailView=Backbone.View.extend({render:function(){var subView;subView=new CIM.views.utils.field.ItemSet({model:this.model,modelCSS:my.CSS,fieldSetFactory:my.fieldSetFactory});this.$el=subView.render().$el;return this}});CIM.viewer.views.v1.quality.report={List:ListView,Detail:DetailView}})(this||window);

(function(root){var CIM=root.CIM;var my={CSS:"cim-v1-shared-cimInfo",fieldSetFactory:function(){return[["Project","project"],["Source","source"],["ID","id"],["Version","version"],["Creation Date","createDate"],["Schema","typeInfo.schema"],["Package","typeInfo.package"],["Type","typeInfo.type"]]}};var DetailView=Backbone.View.extend({render:function(){var subView;subView=new CIM.views.utils.field.ItemSet({model:this.model,modelCSS:my.CSS,fieldSetFactory:my.fieldSetFactory});this.$el=subView.render().$el;return this}});CIM.viewer.views.v1.shared.cimInfo={Detail:DetailView}})(this||window);

(function(root){var CIM=root.CIM;var my={listSortField:"title",CSS:"cim-v1-shared-citation",fieldSetFactory:function(){return[["Short Title","title"],["Full Title","collectiveTitle"],["Type","type"],["Location","location"]]}};var ListView=Backbone.View.extend({render:function(){var subView;subView=new CIM.views.utils.field.List({model:this.model,modelCSS:my.CSS,modelSortField:my.listSortField,fieldSetFactory:my.fieldSetFactory});this.$el=subView.render().$el;return this}});var DetailView=Backbone.View.extend({render:function(){var fsView;fsView=new CIM.views.utils.field.ItemSet({model:this.model,modelCSS:my.CSS,fieldSetFactory:my.fieldSetFactory});this.$el.append(fsView.render().$el);return this}});CIM.viewer.views.v1.shared.citation={List:ListView,Detail:DetailView}})(this||window);

(function(root){var CIM=root.CIM;var my={listSortField:"role",CSS:"cim-v1-shared-responsibleParty",fieldSetFactory:function(model){var fs;fs=[["Role","role"],["Person","individualName"],["Organisation","organisationName"]];if(_.has(model,"contactInfo")){fs=fs.concat([["Address","contactInfo.address"],["Email","contactInfo.email"],["URL","contactInfo.url"]])}return fs}};var ListView=Backbone.View.extend({render:function(){var subView;subView=new CIM.views.utils.field.List({model:this.model,modelCSS:my.CSS,modelSortField:my.listSortField,fieldSetFactory:my.fieldSetFactory});this.$el=subView.render().$el;return this}});var DetailView=Backbone.View.extend({render:function(){var subView;subView=new CIM.views.utils.field.ItemSet({model:this.model,modelCSS:my.CSS,fieldSetFactory:my.fieldSetFactory});this.$el=subView.render().$el;return this}});CIM.viewer.views.v1.shared.responsibleParty={List:ListView,Detail:DetailView}})(this||window);

(function(root){var CIM=root.CIM;var my={listSortField:"shortName",CSS:"cim-v1-software-component",fieldSetFactory:function(){return[["Short Name","shortName"],["Description","description"]]}};var ListView=Backbone.View.extend({render:function(){var subView;subView=new CIM.views.utils.field.List({model:this.model,modelCSS:my.CSS,modelSortField:my.listSortField,fieldSetFactory:my.fieldSetFactory});this.$el=subView.render().$el;return this}});var DetailView=Backbone.View.extend({render:function(){var subView;subView=new CIM.views.utils.field.ItemSet({model:this.model,modelCSS:my.CSS,fieldSetFactory:my.fieldSetFactory});this.$el=subView.render().$el;return this}});CIM.viewer.views.v1.software.component={List:ListView,Detail:DetailView}})(this||window);

(function(root){var CIM=root.CIM;var my={listSortField:"title",CSS:"cim-v1-shared-componentProperty"};var ListView=Backbone.View.extend({className:"cim-v1-shared-componentProperty-list",render:function(){var subViewType,subViewOptions;subViewType=CIM.views.utils.field.GroupSet;subViewOptions={model:this._getFieldGroupSetViewModel(),modelCSS:my.CSS};CIM.utils.render(subViewType,subViewOptions,this);return this},_getFieldGroupSetViewModel:function(){var groupSet=[],properties;properties=_.filter(this.model,function(item){return item.componentProperties.length>0});if(properties.length){groupSet=_.map(properties,function(property){return this._getFieldGroup(property.longName,property.componentProperties)},this);groupSet=_.sortBy(groupSet,"caption")}properties=_.filter(this.model,function(property){return property.componentProperties.length===0});if(properties.length>0){groupSet.unshift(this._getFieldGroup("General",properties))}return groupSet},_getFieldGroup:function(caption,properties){var group={caption:caption,fieldSet:[]};_.each(properties,function(property){group.fieldSet.push({caption:property.shortName,value:this._getComponentPropertyValue(property.values)})},this);return group},_getComponentPropertyValue:function(values){if(values.length===0){return CIM.utils.constants.ui.NULL_FIELD}else{return values.join(" | ")}}});CIM.viewer.views.v1.software.componentProperty={List:ListView}})(this||window);

(function(root){var CIM=root.cim;var my={CSS:"cim-v1-activity-numericalExperiment"};var sections=[{key:"overview",caption:"Overview",viewType:CIM.views.utils.field.ItemSet,viewOptions:{fieldSetFactory:function(){return[["Project","cimInfo.project"],["Short Name","shortName"],["Long Name","longName"],["Description","description"],["Rationale","rationales"]]},modelCSS:my.CSS}},{key:"requirements",caption:"Requirements",viewType:CIM.viewer.views.v1.activity.numericalRequirement.Group,filterModel:function(document){return document.requirements}}];CIM.viewer.views.DocumentView.register({documentType:"1.5-activity-numericalExperiment",sections:sections,renderPriority:2,defaultOptions:{mode:"tabs",sections:[{key:"overview",display:true,mode:"inline"},{key:"requirements",display:true,mode:"inline"}]}})})(this||window);

(function(root){var CIM=root.cim;var my={CSS:"cim-v1-activity-platform"};var sections=[{key:"machine",caption:"Machine",viewType:CIM.views.utils.field.ItemSet,viewOptions:{fieldSetFactory:function(){return[["Name","name"],["Vendor","vendor"],["Operating System","operatingSystem"],["Processor Type","processorType"],["Max. Processors","maximumProcessors"],["Cores / Processor","coresPerProcessor"],["System","system"],["Interconnect","interconnect"],]},modelCSS:my.CSS},filterModel:function(document){if(document.units.length){return document.units[0].machine}return undefined}},{key:"compiler",caption:"Compiler",viewType:CIM.views.utils.field.ItemSet,viewOptions:{fieldSetFactory:function(){return[["Name","name"],["Type","type"],["Version","version"],["Language","language"],["Options","options"],["Env. Variables","environmentVariables"]]},modelCSS:my.CSS},filterModel:function(document){if(document.units.length&&document.units[0].compilers.length){return document.units[0].compilers[0]}return undefined}},{key:"contacts",caption:"Contacts",viewType:CIM.viewer.views.v1.shared.responsibleParty.List,filterModel:function(document){return document.contacts}}];CIM.viewer.views.DocumentView.register({documentType:"1.5-activity-platform",sections:sections,renderPriority:10,defaultOptions:{mode:"tabs",sections:[{key:"machine",display:true,mode:"inline"},{key:"compiler",display:true,mode:"inline"},{key:"contacts",display:true,mode:"inline"}]}})})(this||window);

(function(root){var CIM=root.cim;var my={CSS:"cim-v1-activity-simulationRun"};var sections=[{key:"overview",caption:"Overview",viewType:CIM.views.utils.field.ItemSet,viewOptions:{fieldSetFactory:function(){return[["Project","cimInfo.project"],["Short Name","shortName"],["Long Name","longName"],["Institute","cimInfo.institute"],["Funder","cimInfo.funder"],["ID","simulationId"]]},modelCSS:my.CSS},parseModel:function(document){CIM.utils.setContacts(document.cimInfo,document.responsibleParties)}},{key:"contacts",caption:"Contacts",viewType:CIM.viewer.views.v1.shared.responsibleParty.List,filterModel:function(document){return CIM.utils.remove(document.responsibleParties,"role",["centre","funder"])}},{key:"ensembles",caption:"Ensembles",viewType:CIM.viewer.views.v1.activity.ensemble.List,parseModel:function(document,documentSet){var ensembles;ensembles=_.filter(documentSet,function(doc){return doc.cimTypeInfo.schema==="1.5"&&doc.cimTypeInfo.pkg==="activity"&&doc.cimTypeInfo.type==="ensemble"});_.each(ensembles,function(ensemble){ensemble.type="";_.each(ensemble.types,function(type){if(ensemble.type!==""){ensemble.type+=", "}ensemble.type+=type});ensemble.memberIDs="";_.each(ensemble.members,function(member){_.each(member.ensembleIds,function(ensembleId){if(ensemble.memberIDs!==""){ensemble.memberIDs+=", "}ensemble.memberIDs+=ensembleId.value})})});return ensembles},filterModel:function(document,documentSet){var ensembles;ensembles=_.filter(documentSet,function(doc){return doc.cimTypeInfo.schema==="1.5"&&doc.cimTypeInfo.pkg==="activity"&&doc.cimTypeInfo.type==="ensemble"});return ensembles}}];CIM.viewer.views.DocumentView.register({documentType:"1.5-activity-simulationRun",sections:sections,renderPriority:3,defaultOptions:{mode:"tabs",sections:[{key:"overview",display:true,mode:"inline"},{key:"contacts",display:true,mode:"inline"},{key:"ensembles",display:true,mode:"inline"}]}})})(this||window);

(function(root){var CIM=root.cim;var sections=[{key:"reports",caption:"Reports",viewType:CIM.viewer.views.v1.quality.report.List,filterModel:function(document){return document.reports}}];CIM.viewer.views.DocumentView.register({documentType:"1.5-quality-cIM_Quality",sections:sections,renderPriority:100,defaultOptions:{mode:"tabs",sections:[{key:"reports",display:true,mode:"inline"}]}})})(this||window);

(function(root){var CIM=root.cim;var my={CSS:"cim-v1-software-modelComponent"};var sections=[{key:"overview",caption:"Overview",viewType:CIM.views.utils.field.ItemSet,viewOptions:{fieldSetFactory:function(){return[["Project","cimInfo.project"],["Short Name","shortName"],["Long Name","longName"],["Institute","cimInfo.institute"],["Funder","cimInfo.funder"],["Release Date","releaseDate"],["Language","componentLanguage.name"],["Description","description"]]},modelCSS:my.CSS},parseModel:function(document){CIM.utils.setContacts(document.cimInfo,document.responsibleParties)}},{key:"contacts",caption:"Contacts",viewType:CIM.viewer.views.v1.shared.responsibleParty.List,filterModel:function(document){return CIM.utils.remove(document.responsibleParties,"role",["centre","funder"])}},{key:"citations",caption:"Citations",viewType:CIM.viewer.views.v1.shared.citation.List,filterModel:function(document){return document.citations}},{key:"properties",caption:"Properties",viewType:CIM.viewer.views.v1.software.componentProperty.List,filterModel:function(document){var result=[];if(document.scientificProperties.length){result=result.concat(document.scientificProperties)}if(document.numericalProperties.length){result=result.concat(document.numericalProperties)}if(document.componentProperties.length){result=result.concat(document.componentProperties)}return result}},{key:"components",caption:"Components",viewType:CIM.viewer.views.v1.software.component.List,filterModel:function(document){return document.childComponents}},{key:"grids",caption:"Grids",viewType:CIM.viewer.views.v1.grids.gridSpec.List,filterModel:function(document,documentSet){var grids;grids=_.filter(documentSet,function(doc){return doc.cimTypeInfo.schema==="1.5"&&doc.cimTypeInfo.pkg==="grids"&&doc.cimTypeInfo.type==="gridSpec"});grids=_.map(grids,function(grid){return grid.esmModelGrids[0]});return grids}}];CIM.viewer.views.DocumentView.register({documentType:"1.5-software-modelComponent",sections:sections,renderPriority:1,defaultOptions:{mode:"tabs",sections:[{key:"overview",display:true,mode:"inline"},{key:"contacts",display:true,mode:"inline"},{key:"citations",display:true,mode:"inline"},{key:"properties",display:true,mode:"inline"},{key:"components",display:true,mode:"inline"},{key:"grids",display:true,mode:"inline"}]}})})(this||window);

(function(root){var CIM=root.CIM;var my={JQS:{externalLinks:"a[rel=external]"},CSS:{main:"cim-viewer"}};CIM.viewer.views.DocumentViewport=Backbone.View.extend({className:my.CSS.main,initialize:function(){this._subviews=[];if(this.model.groups.length>1){this._subviews.push(new CIM.viewer.views.viewport.header({model:this.model}))}this._subviews.push(new CIM.viewer.views.viewport.content({model:this.model}));this._subviews.push(new CIM.viewer.views.viewport.footer({model:this.model}))},destroy:function(){_.each(this._subviews,function(subview){subview.destroy()});CIM.viewer.events.off("documentSelected",this.onDocumentSelected)},render:function(){_.each(this._subviews,function(subview){this.$el.append(subview.render().$el)},this);this.$(my.JQS.externalLinks).attr("target","_blank");this._applyUIFramework();return this},_applyUIFramework:function(){switch(CIM.options.uiFramework){case CIM.utils.constants.ui.frameworks.JQUERY:this._applyUIFrameworkJquery();break;default:break}},_applyUIFrameworkJquery:function(){var targets;targets=[["ui-corner-all ui-state-highlight",[".cim-viewer-header-outer",".cim-viewer-footer-outer"]],["ui-widget-header ui-corner-all",[".cim-viewer-header-outer .cim-document-caption span",".cim-viewer-header-outer .cim-document-selector select"]]];CIM.utils.applyCSS(this,targets)}})})(this||window);

(function(root){var CIM=root.CIM;CIM.viewer.views.viewport.content=Backbone.View.extend({className:"cim-viewer-content-outer",initialize:function(){this._documentViews={};this._documentView=undefined;CIM.viewer.events.on("documentSelected",this._onDocumentSelected,this)},destroy:function(){CIM.viewer.events.off("documentSelected",this._onDocumentSelected);this._documentViews=undefined;this._documentView=undefined},_onDocumentSelected:function(document){var view,viewKey;viewKey=document.cimInfo.key;if(_.has(this._documentViews,viewKey)){view=this._documentViews[viewKey]}else{view=this._createDocumentView(document);this._documentViews[viewKey]=view}if(!_.isUndefined(this._documentView)){this._documentView.hide()}this._documentView=view;view.show()},_createDocumentView:function(document){var viewOptions;viewOptions={document:document,documentType:document.cimTypeInfo.key,documentSet:this.model.documents};CIM.utils.render(CIM.viewer.views.DocumentView,viewOptions,this);return this.$(".cim-document-outer").last()}})})(this||window);

(function(root){var CIM=root.CIM;CIM.viewer.views.viewport.footer=Backbone.View.extend({className:"cim-viewer-footer-outer",initialize:function(){CIM.viewer.events.on("documentSelected",this._onDocumentSelected,this)},destroy:function(){CIM.viewer.events.off("documentSelected",this._onDocumentSelected)},render:function(){this.$el.html(this._html);this.$(".plugin a").text(CIM.utils.constants.app.getCaption());return this},_html:"<div class='cim-viewer-footer'>\n                <span class='plugin'>\n                    <a href='https://github.com/ES-DOC/jscim/wiki' rel='external'></a>\n                </span>\n                <span class='document-summary'></span>\n            </div>",_onDocumentSelected:function(document){this.$(".document-summary").text(document.cimDisplayTitle)}})})(this||window);

(function(root){var CIM=root.CIM;CIM.viewer.views.viewport.header=Backbone.View.extend({className:"cim-viewer-header-outer",initialize:function(){this._subViews={}},destroy:function(){_.each(this._subviews,function(subview){subview.destroy()});this._subViews=undefined},render:function(){this.$el.html(this._html);this._renderSubView(CIM.viewer.views.viewport.headerDocumentGroupSelector,"cim-document-group-selector");this._renderSubView(CIM.viewer.views.viewport.headerDocumentCaption,"cim-document-caption");this._renderSubView(CIM.viewer.views.viewport.headerDocumentSelector,"cim-document-selector");return this},_html:"<div class='cim-viewer-header'>\n                    <span class='cim-document-group-selector'></span>\n                    <span class='cim-document-caption'></span>\n                    <span class='cim-document-selector'></span>\n            </div>",_renderSubView:function(subViewType,subViewCSS){var subview;subview=new subViewType(this.options);this.$(".cim-viewer-header ."+subViewCSS).append(subview.render().$el)}})})(this||window);

(function(root){var CIM=root.CIM;CIM.viewer.views.viewport.headerDocumentCaption=Backbone.View.extend({tagName:"span",initialize:function(){CIM.viewer.events.on("documentGroupSelected",this._onDocumentGroupSelected,this);CIM.viewer.events.on("documentSelected",this._onDocumentSelected,this)},destroy:function(){CIM.viewer.events.off("documentGroupSelected",this._onDocumentGroupSelected);CIM.viewer.events.off("documentSelected",this._onDocumentSelected)},_onDocumentSelected:function(document){this.$el.text(document.cimDisplayTitle)},_onDocumentGroupSelected:function(group){if(group.documentSet.length>1){this.$el.hide()}else{this.$el.show()}}})})(this||window);

(function(root){var CIM=root.CIM;CIM.viewer.views.viewport.headerDocumentGroupSelector=Backbone.View.extend({tagName:"span",events:{"click .toolbar-button":"_onDocumentGroupButtonClick"},initialize:function(){CIM.viewer.events.on("documentGroupSelected",this._onDocumentGroupSelected,this)},destroy:function(){CIM.viewer.events.off("documentGroupSelected",this._onDocumentGroupSelected);this._group=undefined},render:function(){this._renderToolbar();this._applyUIFramework();return this},_renderToolbar:function(){var view=this,isFirst=true,button,buttonID,buttonAtts,buttonLabel;_.each(this.model.groups,function(group){buttonID=group.typeKey.replace(".","_")+"-group-button";buttonAtts={id:buttonID,"class":"toolbar-button",type:"radio",name:"cimDocumentSetToolbar"};if(isFirst===true){_.extend(buttonAtts,{checked:"checked"});isFirst=false}button=$jq(view.make("input",buttonAtts));buttonLabel=$jq(view.make("label",{"for":buttonID},group.displayTitle));this.$el.append(button);this.$el.append(buttonLabel)},this)},_applyUIFramework:function(){switch(CIM.options.uiFramework){case CIM.utils.constants.ui.frameworks.JQUERY:this._applyUIFrameworkJQuery();break;default:break}},_applyUIFrameworkJQuery:function(){this.$el.buttonset().find("label").css("width","110px").css("font-size","13px").css("text-transform","uppercase")},_onDocumentGroupSelected:function(group){this._group=group},_onDocumentGroupButtonClick:function(e){var group,typeKey;typeKey=e.currentTarget.id.replace("_",".");typeKey=typeKey.replace("-group-button","");group=_.find(this.model.groups,function(group){return group.typeKey===typeKey});if(!_.isUndefined(group)&&(_.isUndefined(this._group)||this._group.typeKey!==group.typeKey)){CIM.viewer.events.trigger("documentGroupSelected",group)}}})})(this||window);

(function(root){var CIM=root.CIM;CIM.viewer.views.viewport.headerDocumentSelector=Backbone.View.extend({tagName:"select",initialize:function(){CIM.viewer.events.on("documentGroupSelected",this._onDocumentGroupSelected,this)},destroy:function(){CIM.viewer.events.off("documentGroupSelected",this._onDocumentGroupSelected);this._group=undefined},events:{change:"_onDocumentSelectorChange"},_onDocumentGroupSelected:function(group){var option,optionAtts;this._group=group;if(_.isUndefined(group.document)){group.document=group.documentSet[0]}this.$el.empty();_.each(group.documentSet,function(document){optionAtts={value:document.cimInfo.key};if(!_.isUndefined(group.document)&&group.document.cimInfo.key===document.cimInfo.key){_.extend(optionAtts,{selected:"selected"})}option=this.make("option",optionAtts,document.cimDisplayTitle);this.$el.append(option)},this);if(group.documentSet.length>1){this.$el.show()}else{this.$el.hide()}CIM.viewer.events.trigger("documentSelected",group.document)},_onDocumentSelectorChange:function(e){var document;document=_.find(this._group.documentSet,function(doc){return doc.cimInfo.key===e.currentTarget.value});if(!_.isUndefined(document)&&(_.isUndefined(this._group.document)||this._group.document.cimInfo.key!==document.cimInfo.key)){this._group.document=document;CIM.viewer.events.trigger("documentSelected",document)}}})})(this||window);

